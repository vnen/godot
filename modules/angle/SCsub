import string

sources = string.split("""
./thirdparty/third_party/compiler/ArrayBoundsClamper.cpp
./thirdparty/third_party/murmurhash/MurmurHash3.cpp
./thirdparty/third_party/systeminfo/SystemInfo.cpp
./thirdparty/common/angleutils.cpp
./thirdparty/common/debug.cpp
./thirdparty/common/event_tracer.cpp
./thirdparty/common/Float16ToFloat32.cpp
./thirdparty/common/mathutil.cpp
./thirdparty/common/MemoryBuffer.cpp
./thirdparty/common/string_utils.cpp
./thirdparty/common/tls.cpp
./thirdparty/common/utilities.cpp
./thirdparty/compiler/preprocessor/DiagnosticsBase.cpp
./thirdparty/compiler/preprocessor/DirectiveHandlerBase.cpp
./thirdparty/compiler/preprocessor/DirectiveParser.cpp
./thirdparty/compiler/preprocessor/ExpressionParser.cpp
./thirdparty/compiler/preprocessor/Input.cpp
./thirdparty/compiler/preprocessor/Lexer.cpp
./thirdparty/compiler/preprocessor/Macro.cpp
./thirdparty/compiler/preprocessor/MacroExpander.cpp
./thirdparty/compiler/preprocessor/Preprocessor.cpp
./thirdparty/compiler/preprocessor/Token.cpp
./thirdparty/compiler/preprocessor/Tokenizer.cpp
./thirdparty/compiler/translator/AddDefaultReturnStatements.cpp
./thirdparty/compiler/translator/ArrayReturnValueToOutParameter.cpp
./thirdparty/compiler/translator/ASTMetadataHLSL.cpp
./thirdparty/compiler/translator/blocklayout.cpp
./thirdparty/compiler/translator/blocklayoutHLSL.cpp
./thirdparty/compiler/translator/BuiltInFunctionEmulator.cpp
./thirdparty/compiler/translator/BuiltInFunctionEmulatorGLSL.cpp
./thirdparty/compiler/translator/BuiltInFunctionEmulatorHLSL.cpp
./thirdparty/compiler/translator/Cache.cpp
./thirdparty/compiler/translator/CallDAG.cpp
./thirdparty/compiler/translator/CodeGen.cpp
./thirdparty/compiler/translator/Compiler.cpp
./thirdparty/compiler/translator/DeferGlobalInitializers.cpp
./thirdparty/compiler/translator/depgraph/DependencyGraph.cpp
./thirdparty/compiler/translator/depgraph/DependencyGraphBuilder.cpp
./thirdparty/compiler/translator/depgraph/DependencyGraphOutput.cpp
./thirdparty/compiler/translator/depgraph/DependencyGraphTraverse.cpp
./thirdparty/compiler/translator/Diagnostics.cpp
./thirdparty/compiler/translator/DirectiveHandler.cpp
./thirdparty/compiler/translator/EmulatePrecision.cpp
./thirdparty/compiler/translator/ExpandIntegerPowExpressions.cpp
./thirdparty/compiler/translator/ExtensionGLSL.cpp
./thirdparty/compiler/translator/FlagStd140Structs.cpp
./thirdparty/compiler/translator/ForLoopUnroll.cpp
./thirdparty/compiler/translator/glslang_lex.cpp
./thirdparty/compiler/translator/glslang_tab.cpp
./thirdparty/compiler/translator/InfoSink.cpp
./thirdparty/compiler/translator/Initialize.cpp
./thirdparty/compiler/translator/InitializeDll.cpp
./thirdparty/compiler/translator/InitializeParseContext.cpp
./thirdparty/compiler/translator/InitializeVariables.cpp
./thirdparty/compiler/translator/Intermediate.cpp
./thirdparty/compiler/translator/IntermNode.cpp
./thirdparty/compiler/translator/IntermNodePatternMatcher.cpp
./thirdparty/compiler/translator/intermOut.cpp
./thirdparty/compiler/translator/IntermTraverse.cpp
./thirdparty/compiler/translator/LoopInfo.cpp
./thirdparty/compiler/translator/Operator.cpp
./thirdparty/compiler/translator/OutputESSL.cpp
./thirdparty/compiler/translator/OutputGLSL.cpp
./thirdparty/compiler/translator/OutputGLSLBase.cpp
./thirdparty/compiler/translator/OutputHLSL.cpp
./thirdparty/compiler/translator/ParseContext.cpp
./thirdparty/compiler/translator/PoolAlloc.cpp
./thirdparty/compiler/translator/PruneEmptyDeclarations.cpp
./thirdparty/compiler/translator/RecordConstantPrecision.cpp
./thirdparty/compiler/translator/RegenerateStructNames.cpp
./thirdparty/compiler/translator/RemoveDynamicIndexing.cpp
./thirdparty/compiler/translator/RemovePow.cpp
./thirdparty/compiler/translator/RemoveSwitchFallThrough.cpp
./thirdparty/compiler/translator/RewriteDoWhile.cpp
./thirdparty/compiler/translator/RewriteElseBlocks.cpp
./thirdparty/compiler/translator/ScalarizeVecAndMatConstructorArgs.cpp
./thirdparty/compiler/translator/SearchSymbol.cpp
./thirdparty/compiler/translator/SeparateArrayInitialization.cpp
./thirdparty/compiler/translator/SeparateDeclarations.cpp
./thirdparty/compiler/translator/SeparateExpressionsReturningArrays.cpp
./thirdparty/compiler/translator/ShaderLang.cpp
./thirdparty/compiler/translator/ShaderVars.cpp
./thirdparty/compiler/translator/SplitSequenceOperator.cpp
./thirdparty/compiler/translator/StructureHLSL.cpp
./thirdparty/compiler/translator/SymbolTable.cpp
./thirdparty/compiler/translator/TextureFunctionHLSL.cpp
./thirdparty/compiler/translator/timing/RestrictFragmentShaderTiming.cpp
./thirdparty/compiler/translator/timing/RestrictVertexShaderTiming.cpp
./thirdparty/compiler/translator/TranslatorESSL.cpp
./thirdparty/compiler/translator/TranslatorGLSL.cpp
./thirdparty/compiler/translator/TranslatorHLSL.cpp
./thirdparty/compiler/translator/Types.cpp
./thirdparty/compiler/translator/UnfoldShortCircuitAST.cpp
./thirdparty/compiler/translator/UnfoldShortCircuitToIf.cpp
./thirdparty/compiler/translator/UniformHLSL.cpp
./thirdparty/compiler/translator/util.cpp
./thirdparty/compiler/translator/UtilsHLSL.cpp
./thirdparty/compiler/translator/ValidateGlobalInitializer.cpp
./thirdparty/compiler/translator/ValidateLimitations.cpp
./thirdparty/compiler/translator/ValidateMaxParameters.cpp
./thirdparty/compiler/translator/ValidateOutputs.cpp
./thirdparty/compiler/translator/ValidateSwitch.cpp
./thirdparty/compiler/translator/VariableInfo.cpp
./thirdparty/compiler/translator/VariablePacker.cpp
./thirdparty/compiler/translator/VersionGLSL.cpp
./thirdparty/image_util/copyimage.cpp
./thirdparty/image_util/imageformats.cpp
./thirdparty/image_util/loadimage.cpp
./thirdparty/image_util/loadimage_etc.cpp
./thirdparty/libANGLE/angletypes.cpp
./thirdparty/libANGLE/AttributeMap.cpp
./thirdparty/libANGLE/Buffer.cpp
./thirdparty/libANGLE/Caps.cpp
./thirdparty/libANGLE/Compiler.cpp
./thirdparty/libANGLE/Config.cpp
./thirdparty/libANGLE/Context.cpp
./thirdparty/libANGLE/ContextState.cpp
./thirdparty/libANGLE/Debug.cpp
./thirdparty/libANGLE/Device.cpp
./thirdparty/libANGLE/Display.cpp
./thirdparty/libANGLE/Error.cpp
./thirdparty/libANGLE/Fence.cpp
./thirdparty/libANGLE/formatutils.cpp
./thirdparty/libANGLE/Framebuffer.cpp
./thirdparty/libANGLE/FramebufferAttachment.cpp
./thirdparty/libANGLE/HandleAllocator.cpp
./thirdparty/libANGLE/HandleRangeAllocator.cpp
./thirdparty/libANGLE/Image.cpp
./thirdparty/libANGLE/ImageIndex.cpp
./thirdparty/libANGLE/IndexRangeCache.cpp
./thirdparty/libANGLE/Path.cpp
./thirdparty/libANGLE/Platform.cpp
./thirdparty/libANGLE/Program.cpp
./thirdparty/libANGLE/Query.cpp
./thirdparty/libANGLE/queryconversions.cpp
./thirdparty/libANGLE/Renderbuffer.cpp
./thirdparty/libANGLE/renderer/ContextImpl.cpp
./thirdparty/libANGLE/renderer/DeviceImpl.cpp
./thirdparty/libANGLE/renderer/DisplayImpl.cpp
./thirdparty/libANGLE/renderer/renderer_utils.cpp
./thirdparty/libANGLE/renderer/SurfaceImpl.cpp
./thirdparty/libANGLE/ResourceManager.cpp
./thirdparty/libANGLE/Sampler.cpp
./thirdparty/libANGLE/Shader.cpp
./thirdparty/libANGLE/signal_utils.cpp
./thirdparty/libANGLE/State.cpp
./thirdparty/libANGLE/Stream.cpp
./thirdparty/libANGLE/Surface.cpp
./thirdparty/libANGLE/Texture.cpp
./thirdparty/libANGLE/TransformFeedback.cpp
./thirdparty/libANGLE/Uniform.cpp
./thirdparty/libANGLE/validationEGL.cpp
./thirdparty/libANGLE/validationES.cpp
./thirdparty/libANGLE/validationES2.cpp
./thirdparty/libANGLE/validationES3.cpp
./thirdparty/libANGLE/VertexArray.cpp
./thirdparty/libANGLE/VertexAttribute.cpp
./thirdparty/libGLESv2/global_state.cpp
./thirdparty/libGLESv2/libGLESv2.cpp
./thirdparty/libEGL/libEGL.cpp
""")

entry_points_src = string.split("""
./thirdparty/libGLESv2/entry_points_egl.cpp
./thirdparty/libGLESv2/entry_points_egl_ext.cpp
./thirdparty/libGLESv2/entry_points_gles_2_0.cpp
./thirdparty/libGLESv2/entry_points_gles_2_0_ext.cpp
./thirdparty/libGLESv2/entry_points_gles_3_0.cpp
./thirdparty/libGLESv2/entry_points_gles_3_1.cpp
""")

win32_src = string.split("""
./thirdparty/libANGLE/renderer/d3d/d3d11/win32/NativeWindow11Win32.cpp
""")

winrt_src = string.split("""
./thirdparty/libANGLE/renderer/d3d/d3d11/winrt/CoreWindowNativeWindow.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/winrt/InspectableNativeWindow.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/winrt/NativeWindow11WinRT.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/winrt/SwapChainPanelNativeWindow.cpp
""")

d3d_src = string.split("""
./thirdparty/libANGLE/renderer/d3d/BufferD3D.cpp
./thirdparty/libANGLE/renderer/d3d/CompilerD3D.cpp
./thirdparty/libANGLE/renderer/d3d/DeviceD3D.cpp
./thirdparty/libANGLE/renderer/d3d/DisplayD3D.cpp
./thirdparty/libANGLE/renderer/d3d/DynamicHLSL.cpp
./thirdparty/libANGLE/renderer/d3d/EGLImageD3D.cpp
./thirdparty/libANGLE/renderer/d3d/FramebufferD3D.cpp
./thirdparty/libANGLE/renderer/d3d/HLSLCompiler.cpp
./thirdparty/libANGLE/renderer/d3d/ImageD3D.cpp
./thirdparty/libANGLE/renderer/d3d/IndexBuffer.cpp
./thirdparty/libANGLE/renderer/d3d/IndexDataManager.cpp
./thirdparty/libANGLE/renderer/d3d/NativeWindowD3D.cpp
./thirdparty/libANGLE/renderer/d3d/ProgramD3D.cpp
./thirdparty/libANGLE/renderer/d3d/RenderbufferD3D.cpp
./thirdparty/libANGLE/renderer/d3d/RendererD3D.cpp
./thirdparty/libANGLE/renderer/d3d/RenderTargetD3D.cpp
./thirdparty/libANGLE/renderer/d3d/ShaderD3D.cpp
./thirdparty/libANGLE/renderer/d3d/ShaderExecutableD3D.cpp
./thirdparty/libANGLE/renderer/d3d/SurfaceD3D.cpp
./thirdparty/libANGLE/renderer/d3d/TextureD3D.cpp
./thirdparty/libANGLE/renderer/d3d/VaryingPacking.cpp
./thirdparty/libANGLE/renderer/d3d/VertexBuffer.cpp
./thirdparty/libANGLE/renderer/d3d/VertexDataManager.cpp
""")

d3d9_src = string.split("""
./thirdparty/libANGLE/renderer/d3d/d3d9/Blit9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/Buffer9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/Context9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/DebugAnnotator9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/Fence9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/formatutils9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/Framebuffer9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/Image9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/IndexBuffer9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/NativeWindow9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/Query9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/Renderer9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/renderer9_utils.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/RenderTarget9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/ShaderExecutable9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/StateManager9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/SwapChain9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/TextureStorage9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/VertexBuffer9.cpp
./thirdparty/libANGLE/renderer/d3d/d3d9/VertexDeclarationCache.cpp
""")

d3d11_src = string.split("""
./thirdparty/libANGLE/renderer/d3d/d3d11/Blit11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Buffer11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Clear11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Context11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/DebugAnnotator11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/dxgi_support_table.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Fence11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/formatutils11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Framebuffer11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Image11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/IndexBuffer11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/InputLayoutCache.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/load_functions_table_autogen.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/PixelTransfer11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Query11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Renderer11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/renderer11_utils.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/RenderStateCache.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/RenderTarget11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/ShaderExecutable11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/StateManager11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/StreamProducerNV12.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/SwapChain11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/TextureStorage11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/texture_format_table_autogen.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/TransformFeedback11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/Trim11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/VertexArray11.cpp
./thirdparty/libANGLE/renderer/d3d/d3d11/VertexBuffer11.cpp
""")

android_src = string.split("""
./thirdparty/libANGLE/renderer/gl/egl/android/DisplayAndroid.cpp
""")

gl_src = string.split("""
./thirdparty/libANGLE/renderer/gl/BlitGL.cpp
./thirdparty/libANGLE/renderer/gl/BufferGL.cpp
./thirdparty/libANGLE/renderer/gl/CompilerGL.cpp
./thirdparty/libANGLE/renderer/gl/ContextGL.cpp
./thirdparty/libANGLE/renderer/gl/DisplayGL.cpp
./thirdparty/libANGLE/renderer/gl/egl/DisplayEGL.cpp
./thirdparty/libANGLE/renderer/gl/egl/FunctionsEGL.cpp
./thirdparty/libANGLE/renderer/gl/egl/FunctionsEGLDL.cpp
./thirdparty/libANGLE/renderer/gl/egl/ozone/DisplayOzone.cpp
./thirdparty/libANGLE/renderer/gl/egl/ozone/SurfaceOzone.cpp
./thirdparty/libANGLE/renderer/gl/egl/PbufferSurfaceEGL.cpp
./thirdparty/libANGLE/renderer/gl/egl/SurfaceEGL.cpp
./thirdparty/libANGLE/renderer/gl/egl/WindowSurfaceEGL.cpp
./thirdparty/libANGLE/renderer/gl/FenceNVGL.cpp
./thirdparty/libANGLE/renderer/gl/FenceSyncGL.cpp
./thirdparty/libANGLE/renderer/gl/formatutilsgl.cpp
./thirdparty/libANGLE/renderer/gl/FramebufferGL.cpp
./thirdparty/libANGLE/renderer/gl/FunctionsGL.cpp
./thirdparty/libANGLE/renderer/gl/glx/DisplayGLX.cpp
./thirdparty/libANGLE/renderer/gl/glx/FunctionsGLX.cpp
./thirdparty/libANGLE/renderer/gl/glx/PbufferSurfaceGLX.cpp
./thirdparty/libANGLE/renderer/gl/glx/WindowSurfaceGLX.cpp
./thirdparty/libANGLE/renderer/gl/PathGL.cpp
./thirdparty/libANGLE/renderer/gl/ProgramGL.cpp
./thirdparty/libANGLE/renderer/gl/QueryGL.cpp
./thirdparty/libANGLE/renderer/gl/RenderbufferGL.cpp
./thirdparty/libANGLE/renderer/gl/RendererGL.cpp
./thirdparty/libANGLE/renderer/gl/renderergl_utils.cpp
./thirdparty/libANGLE/renderer/gl/SamplerGL.cpp
./thirdparty/libANGLE/renderer/gl/ShaderGL.cpp
./thirdparty/libANGLE/renderer/gl/StateManagerGL.cpp
./thirdparty/libANGLE/renderer/gl/SurfaceGL.cpp
./thirdparty/libANGLE/renderer/gl/TextureGL.cpp
./thirdparty/libANGLE/renderer/gl/TransformFeedbackGL.cpp
./thirdparty/libANGLE/renderer/gl/VertexArrayGL.cpp
./thirdparty/libANGLE/renderer/gl/wgl/DisplayWGL.cpp
./thirdparty/libANGLE/renderer/gl/wgl/DXGISwapChainWindowSurfaceWGL.cpp
./thirdparty/libANGLE/renderer/gl/wgl/FunctionsWGL.cpp
./thirdparty/libANGLE/renderer/gl/wgl/PbufferSurfaceWGL.cpp
./thirdparty/libANGLE/renderer/gl/wgl/wgl_utils.cpp
./thirdparty/libANGLE/renderer/gl/wgl/WindowSurfaceWGL.cpp
""")

vulkan_src = string.split("""
./thirdparty/libANGLE/renderer/vulkan/BufferVk.cpp
./thirdparty/libANGLE/renderer/vulkan/CompilerVk.cpp
./thirdparty/libANGLE/renderer/vulkan/ContextVk.cpp
./thirdparty/libANGLE/renderer/vulkan/DeviceVk.cpp
./thirdparty/libANGLE/renderer/vulkan/DisplayVk.cpp
./thirdparty/libANGLE/renderer/vulkan/FenceNVVk.cpp
./thirdparty/libANGLE/renderer/vulkan/FenceSyncVk.cpp
./thirdparty/libANGLE/renderer/vulkan/FramebufferVk.cpp
./thirdparty/libANGLE/renderer/vulkan/ImageVk.cpp
./thirdparty/libANGLE/renderer/vulkan/ProgramVk.cpp
./thirdparty/libANGLE/renderer/vulkan/QueryVk.cpp
./thirdparty/libANGLE/renderer/vulkan/RenderbufferVk.cpp
./thirdparty/libANGLE/renderer/vulkan/RendererVk.cpp
./thirdparty/libANGLE/renderer/vulkan/SamplerVk.cpp
./thirdparty/libANGLE/renderer/vulkan/ShaderVk.cpp
./thirdparty/libANGLE/renderer/vulkan/SurfaceVk.cpp
./thirdparty/libANGLE/renderer/vulkan/TextureVk.cpp
./thirdparty/libANGLE/renderer/vulkan/TransformFeedbackVk.cpp
./thirdparty/libANGLE/renderer/vulkan/VertexArrayVk.cpp
""")

sources = sources + entry_points_src

Import('env')

platform = ""
libs = []
defines = []

if "platform" in env:
	platform = env["platform"]
elif "p" in env:
	platform = env["p"]

if platform == "winrt":
	sources = sources + winrt_src + d3d_src + d3d11_src
	libs = libs + string.split("""
		uuid
		Cfgmgr32
		dxguid
		d3d11
		d3dcompiler
		setupapi
	""")
	defines = defines + string.split("""
		-D_CRT_SECURE_NO_DEPRECATE
		-D_SCL_SECURE_NO_WARNINGS
		-D_HAS_EXCEPTIONS=0
		-DNOMINMAX
		-DLIBANGLE_IMPLEMENTATION
		-DLIBGLESV2_IMPLEMENTATION
		-DANGLE_TRANSLATOR_IMPLEMENTATION
		-DANGLE_ENABLE_GLSL
		-DANGLE_ENABLE_HLSL
		-DANGLE_ENABLE_D3D11
		-DANGLE_STANDALONE_BUILD
		-DANGLE_TRANSLATOR_STATIC
		-DNDEBUG
		-DGL_GLEXT_PROTOTYPES
	""")

env.Append(CPPPATH=['#modules/angle/thirdparty/include'])
env.Append(CCFLAGS=['-DGL_APICALL=', '-DEGLAPI='])
env.Append(LINKFLAGS=[p+".lib" for p in libs])

env_angle = env.Clone()
env_angle.Append(CCFLAGS=defines)
env_angle.Append(CPPPATH=['#modules/angle/thirdparty', '#modules/angle/thirdparty/common/third_party/numerics'])
env_angle.add_source_files(env.modules_sources,sources)

Export('env_angle')
